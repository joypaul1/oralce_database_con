//----This script is used to insert customer profile data into the CUSTOMER_PROFILE table.//

INSERT INTO CUSTOMER_CODE_PROFILE.CUSTOMER_PROFILE (CUST_NAME, CUST_MOBILE, CUST_ADDRESS, CUST_CODE)
SELECT CUSTOMER_NAME, CUSTOMER_MOBILE_NO, PARTY_ADDRESS, PARTYCDE
FROM (
    SELECT CUSTOMER_NAME, CUSTOMER_MOBILE_NO, PARTY_ADDRESS, PARTYCDE,
           ROW_NUMBER() OVER (PARTITION BY PARTYCDE ORDER BY ROWID DESC) AS rn
    FROM DEVELOPERS.EMI_ERP_VIEW_DATA
    WHERE PARTYCDE IS NOT NULL
)
WHERE rn = 1
  AND PARTYCDE NOT IN ( 
      SELECT CUST_CODE FROM CUSTOMER_CODE_PROFILE.CUSTOMER_PROFILE
  );
  //----This script is used to insert customer profile data into the CUSTOMER_PROFILE table.//


//----This script is used to insert CODE WISE profile STATUS data into the CODE_WISE_STATUS table.//
INSERT INTO CUSTOMER_CODE_PROFILE.CODE_WISE_STATUS (CUST_CODE, REF_CODE, PAYMENT_MODE, CODE_STATUS,NUMBER_OF_DUE)
SELECT  PARTYCDE,REF_CODE, SALES_TYPE, STATUS, NUMBER_OF_DUE
FROM (
    SELECT PARTYCDE,REF_CODE, SALES_TYPE, STATUS, NUMBER_OF_DUE,
           ROW_NUMBER() OVER (PARTITION BY PARTYCDE ORDER BY ROWID DESC) AS rn
    FROM DEVELOPERS.EMI_ERP_VIEW_DATA
    WHERE PARTYCDE IS NOT NULL
)
WHERE rn = 1
  AND PARTYCDE NOT IN (
      SELECT CUST_CODE FROM CUSTOMER_CODE_PROFILE.CODE_WISE_STATUS;
  );
//----This script is used to insert CODE WISE profile STATUS data into the CODE_WISE_STATUS table.//

********--WORKING PLAN ---- ************
EMI COLLECTION ENTRY   ->  
money_collection.php


CUSTOMER VISIT ---> CODE VISIT OR NOT
meet_visit_assign_customer.php
visit_assign_list.php

///CREDIT CUSTOMER --> EMI VIEW DATA
ALL CODE -->  CUSTOMER, MOBILE ,LAT & LANG  (PROFILE) (LAST MEET VISIT LOCATION), HISTORY OF LOCATION (3 ATTEMPT)
REF_CODE -->  REF CODE (++),CUSTOMER_ID